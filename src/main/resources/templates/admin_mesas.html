<!DOCTYPE html>
<html lang="es" 
      xmlns:th="http://www.thymeleaf.org"     
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/master}">
<head>
    <title>Administración de Mesas - Sabor Gourmet</title>
</head>
<body>
    <div layout:fragment="content">
        <div class="container mt-4">
            <!-- Header con título y botón de crear -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1>Panel de Administración de Mesas</h1>
                <a href="/admin/mesas/nueva" class="btn btn-success btn-lg">
                    <i class="fa-solid fa-plus me-2"></i>Crear Nueva Mesa
                </a>
            </div>

            <!-- Mensaje si no hay mesas -->
            <div th:if="${#lists.isEmpty(mesas)}" class="row">
                <div class="col-12">
                    <div class="alert alert-info text-center" role="alert">
                        <i class="fa-solid fa-info-circle me-2"></i>
                        No hay mesas registradas en el sistema. Comienza creando una nueva mesa.
                    </div>
                </div>
            </div>

            <!-- aca muestro las tarjetas de mesas -->
            <div class="row">
                <div th:each="mesa : ${mesas}" class="col-md-6 col-lg-4 col-xl-3 mb-4">
                    <div class="card h-100 shadow-sm" th:classappend="${!mesa.disponible} ? 'border-danger' : 'border-success'">
                        <div class="card-header text-center" th:classappend="${mesa.disponible} ? 'bg-success bg-opacity-10' : 'bg-danger bg-opacity-10'">
                            <h5 class="mb-0">
                                <i class="fa-solid fa-chair me-2" th:classappend="${mesa.disponible} ? 'text-success' : 'text-danger'"></i>
                                Mesa N° <span th:text="${mesa.id}"></span>
                            </h5>
                        </div>
                        <div class="card-body text-center">
                            <p class="card-text mb-2">
                                <i class="fa-solid fa-users me-2 text-primary"></i>
                                Capacidad: <strong th:text="${mesa.capacidad}"></strong> personas
                            </p>
                            <p class="card-text">
                                Estado:
                                <span th:if="${mesa.disponible}" class="badge bg-success">
                                    <i class="fa-solid fa-check me-1"></i>Disponible
                                </span>
                                <span th:unless="${mesa.disponible}" class="badge bg-danger">
                                    <i class="fa-solid fa-times me-1"></i>No Disponible
                                </span>
                            </p>
                        </div>
                        <div class="card-footer bg-transparent">
                            <div class="d-grid gap-2">
                                <!-- aca tengo boton para Editar -->
                                <a th:href="@{/admin/mesas/editar/{id}(id=${mesa.id})}" class="btn btn-primary btn-sm">
                                    <i class="fa-solid fa-edit me-1"></i>Editar
                                </a>
                                <!-- aca tengo boton para Cambiar Estado -->
                                <form th:action="@{/admin/mesas/cambiar-estado/{id}(id=${mesa.id})}" method="post" class="w-100">
                                    <button type="submit" class="btn btn-warning btn-sm w-100">
                                        <i class="fa-solid fa-toggle-on me-1"></i>Cambiar Estado
                                    </button>
                                </form>
                                <!-- aca tengo boton para Eliminar -->
                                <form th:action="@{/admin/mesas/eliminar/{id}(id=${mesa.id})}"
                                      method="post"
                                      class="w-100"
                                      th:onsubmit="|return confirm('¿Está seguro de que desea eliminar la mesa N° ${mesa.numero}?');|">
                                    <button type="submit" class="btn btn-danger btn-sm w-100">
                                        <i class="fa-solid fa-trash me-1"></i>Eliminar
                                    </button>
                                </form>
                                <!-- aca tengo boton para Eliminar la reservar, ojo se eleminira solo la reserva, ya que el cliente puede tener mas reservas-->
                                <a th:href="@{/admin/mesas/eliminarReserva/{id}(id=${mesa.id})}"
                                   class="btn btn-secondary btn-sm w-100">
                                    <i class="fa-solid fa-book-open me-1"></i>Reservas
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
